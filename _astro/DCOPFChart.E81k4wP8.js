import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{R as d}from"./index.D1QmYGpb.js";import"./_commonjsHelpers.Cpj98o6Y.js";const h=[1,2,3],o=[{bus:1,Pmin:0,Pmax:100,cost:10},{bus:2,Pmin:0,Pmax:100,cost:20}],m=[{from:1,to:2,x:.1,limit:100},{from:2,to:3,x:.1,limit:100},{from:3,to:1,x:.1,limit:100}];function f(){const r=h.length,n=Array.from({length:r},()=>Array(r).fill(0));for(const t of m){const i=t.from-1,s=t.to-1,l=1/t.x;n[i][i]+=l,n[s][s]+=l,n[i][s]-=l,n[s][i]-=l}return n}function u(r){const n=f(),t=[1,2],i=[[n[t[0]][t[0]],n[t[0]][t[1]]],[n[t[1]][t[0]],n[t[1]][t[1]]]],s=[r[t[0]],r[t[1]]],l=i[0][0]*i[1][1]-i[0][1]*i[1][0];if(Math.abs(l)<1e-9)return[0,0,0];const a=[[i[1][1]/l,-i[0][1]/l],[-i[1][0]/l,i[0][0]/l]],c=a[0][0]*s[0]+a[0][1]*s[1],x=a[1][0]*s[0]+a[1][1]*s[1];return[0,c,x]}function j(r){return m.map(n=>1/n.x*(r[n.from-1]-r[n.to-1]))}function p(r){return r.every((n,t)=>Math.abs(n)<=m[t].limit+1e-6)}function y(r,n){return r*o[0].cost+n*o[1].cost}function b(r,n=1){let t=null;for(let i=o[0].Pmin;i<=o[0].Pmax;i+=n){const s=r-i;if(s<o[1].Pmin-1e-9||s>o[1].Pmax+1e-9)continue;const l=[i,s,-r],a=u(l),c=j(a);if(!p(c))continue;const x=y(i,s);(!t||x<t.cost)&&(t={pg1:i,pg2:s,theta:a,flows:c,cost:x})}return t}function w(){const[r,n]=d.useState(150),[t,i]=d.useState(1),s=d.useMemo(()=>b(r,t),[r,t]);return e.jsxs("div",{className:"p-4 bg-white rounded-2xl shadow max-w-3xl mx-auto",children:[e.jsx("h2",{className:"text-xl font-bold mb-3 text-center",children:"3-Bus DC-OPF Chart"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3 mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{type:"range",min:0,max:200,step:10,value:r,onChange:l=>n(parseInt(l.target.value)),className:"w-full"}),e.jsxs("p",{className:"text-center text-sm text-gray-600",children:["Demand at Bus 3: ",e.jsxs("strong",{children:[r," MW"]})]})]}),e.jsxs("label",{className:"text-sm text-gray-600",children:["Search step:",e.jsxs("select",{className:"ml-2 border rounded px-2 py-1",value:t,onChange:l=>i(parseInt(l.target.value)),children:[e.jsx("option",{value:1,children:"1 MW"}),e.jsx("option",{value:5,children:"5 MW"}),e.jsx("option",{value:10,children:"10 MW"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[e.jsx("h3",{className:"font-semibold mb-2 text-sm text-gray-700",children:"Network Flows"}),e.jsx("div",{className:"w-full h-64",children:e.jsxs("svg",{viewBox:"0 0 300 260",className:"w-full h-full",children:[e.jsx("circle",{cx:"150",cy:"30",r:"14",fill:"#fff",stroke:"#111"}),e.jsx("text",{x:"150",y:"30",textAnchor:"middle",dominantBaseline:"middle",fontSize:"12",children:"Bus 1"}),e.jsx("circle",{cx:"40",cy:"210",r:"14",fill:"#fff",stroke:"#111"}),e.jsx("text",{x:"40",y:"210",textAnchor:"middle",dominantBaseline:"middle",fontSize:"12",children:"Bus 2"}),e.jsx("circle",{cx:"260",cy:"210",r:"14",fill:"#fff",stroke:"#111"}),e.jsx("text",{x:"260",y:"210",textAnchor:"middle",dominantBaseline:"middle",fontSize:"12",children:"Bus 3"}),e.jsx("defs",{children:e.jsx("marker",{id:"arrow",viewBox:"0 0 10 10",refX:"6",refY:"5",markerWidth:"6",markerHeight:"6",orient:"auto-start-reverse",children:e.jsx("path",{d:"M 0 0 L 10 5 L 0 10 z"})})}),e.jsx("line",{x1:"150",y1:"30",x2:"40",y2:"210",stroke:"#3b82f6",strokeWidth:"2",markerEnd:"url(#arrow)"}),e.jsx("line",{x1:"40",y1:"210",x2:"260",y2:"210",stroke:"#3b82f6",strokeWidth:"2",markerEnd:"url(#arrow)"}),e.jsx("line",{x1:"260",y1:"210",x2:"150",y2:"30",stroke:"#3b82f6",strokeWidth:"2",markerEnd:"url(#arrow)"}),s&&e.jsxs(e.Fragment,{children:[e.jsxs("text",{x:"90",y:"120",textAnchor:"middle",fontSize:"12",children:["L1 1→2: ",s.flows[0].toFixed(1)," MW"]}),e.jsxs("text",{x:"150",y:"230",textAnchor:"middle",fontSize:"12",children:["L2 2→3: ",s.flows[1].toFixed(1)," MW"]}),e.jsxs("text",{x:"205",y:"120",textAnchor:"middle",fontSize:"12",children:["L3 3→1: ",s.flows[2].toFixed(1)," MW"]})]})]})})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[e.jsx("h3",{className:"font-semibold mb-2 text-sm text-gray-700",children:"Dispatch & Angles"}),s?e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Gen 1 @ Bus 1"}),e.jsxs("span",{className:"font-mono",children:[s.pg1.toFixed(0)," MW"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Gen 2 @ Bus 2"}),e.jsxs("span",{className:"font-mono",children:[s.pg2.toFixed(0)," MW"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Cost"}),e.jsxs("span",{className:"font-mono",children:["$",s.cost.toFixed(2),"/h"]})]}),e.jsx("hr",{}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"θ₁ (slack)"}),e.jsx("span",{className:"font-mono",children:"0.000"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"θ₂"}),e.jsxs("span",{className:"font-mono",children:[s.theta[1].toFixed(4)," rad"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"θ₃"}),e.jsxs("span",{className:"font-mono",children:[s.theta[2].toFixed(4)," rad"]})]})]}):e.jsx("p",{className:"text-sm text-red-600",children:"Infeasible at this demand with current line limits."})]})]})]})}export{w as default};
